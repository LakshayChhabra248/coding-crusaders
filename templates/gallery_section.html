{% extends 'base.html' %}
{% load static %}

{% block content %}
<main>
  <section id="gallery-section" class="section gallery-section">
    <div class="container">
      <!-- Header with Back Button -->
      <div class="gallery-header">
        <a href="{% url 'main:gallery_index' %}" class="back-link">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="19" y1="12" x2="5" y2="12"></line>
            <polyline points="12 19 5 12 12 5"></polyline>
          </svg>
          Back to Collections
        </a>
      </div>

      <!-- Section Info -->
      <div class="section-header">
        <h1 class="gradient-title">{{ section.title }}</h1>
        {% if section.description %}
          <p class="section-subtitle">{{ section.description }}</p>
        {% endif %}
      </div>

      <!-- Image Count Stats -->
      <div class="gallery-stats">
        <div class="stat-item">
          <span class="stat-number">{{ images|length }}</span>
          <span class="stat-label">Image{{ images|length|pluralize }}</span>
        </div>
      </div>

      <!-- Gallery Grid -->
      <div class="gallery-grid">
        {% for img in images %}
        <figure class="gallery-item glass">
          <a href="{{ img.image.url }}" class="gallery-link" data-caption="{{ img.caption|escapejs }}">
            <img 
              data-src="{{ img.image.url }}" 
              src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='10' height='10'><rect width='100%' height='100%' fill='%23071023'/></svg>" 
              alt="{{ img.caption|default:section.title }}" 
              loading="lazy"
              class="gallery-image">
            <div class="image-overlay">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M8 3C4.13401 3 1 6.13401 1 10V20C1 23.866 4.13401 27 8 27H18C21.866 27 25 23.866 25 20V10C25 6.13401 21.866 3 18 3H8ZM8 5H18C20.7614 5 23 7.23858 23 10V20C23 22.7614 20.7614 25 18 25H8C5.23858 25 3 22.7614 3 20V10C3 7.23858 5.23858 5 8 5ZM12 7C9.23858 7 7 9.23858 7 12C7 14.7614 9.23858 17 12 17C14.7614 17 17 14.7614 17 12C17 9.23858 14.7614 7 12 7ZM12 9C13.6569 9 15 10.3431 15 12C15 13.6569 13.6569 15 12 15C10.3431 15 9 13.6569 9 12C9 10.3431 10.3431 9 12 9Z"></path>
              </svg>
            </div>
          </a>
          {% if img.caption %}
            <figcaption class="image-caption">{{ img.caption }}</figcaption>
          {% endif %}
        </figure>
        {% empty %}
        <div class="empty-state glass">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="var(--accent)" stroke-width="1.5">
            <rect x="3" y="3" width="18" height="18" rx="2"></rect>
            <circle cx="8.5" cy="8.5" r="1.5"></circle>
            <path d="M21 15l-5-5L5 21"></path>
          </svg>
          <h3>No images in this collection</h3>
          <p>Check back soon for updates</p>
        </div>
        {% endfor %}
      </div>

      <!-- Footer -->
      <div class="gallery-footer">
        <a class="btn primary" href="{% url 'main:gallery_index' %}">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="19" y1="12" x2="5" y2="12"></line>
            <polyline points="12 19 5 12 12 5"></polyline>
          </svg>
          Back to Collections
        </a>
      </div>
    </div>
  </section>

  <!-- Lightbox modal -->
  <div id="lightbox" aria-hidden="true">
    <div class="lightbox-backdrop" data-close></div>
    <div class="lightbox-dialog">
      <button class="lightbox-close" data-close aria-label="Close">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
      <button class="lightbox-arrow lightbox-prev" data-prev aria-label="Previous">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="19" y1="12" x2="5" y2="12"></line>
          <polyline points="12 19 5 12 12 5"></polyline>
        </svg>
      </button>
      <button class="lightbox-arrow lightbox-next" data-next aria-label="Next">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="5" y1="12" x2="19" y2="12"></line>
          <polyline points="12 5 19 12 12 19"></polyline>
        </svg>
      </button>
      <div class="lightbox-actions">
        <a id="lightbox-download" class="lightbox-download" href="#" download aria-label="Download image">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"></path>
            <polyline points="7 10 12 15 17 10"></polyline>
            <line x1="12" y1="15" x2="12" y2="3"></line>
          </svg>
          Download
        </a>
      </div>
      <img id="lightbox-img" src="" alt="">
      <div class="lightbox-caption"></div>
    </div>
  </div>
</main>
{% endblock %}
